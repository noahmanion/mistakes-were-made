<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Adwords Scripts &#8211; Noah Manion: These are my thoughts.</title>
<meta name="description" content="Use AdWords Scripts & the Twilio API to keep track of when things go out of stock">
<meta name="keywords" content="posts, Noah">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Adwords Scripts">
<meta name="twitter:description" content="Use AdWords Scripts & the Twilio API to keep track of when things go out of stock">
<meta name="twitter:site" content="@noahmanion">
<meta name="twitter:creator" content="@noahmanion">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://noahmanion.github.io/images/l.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Adwords Scripts">
<meta property="og:description" content="Use AdWords Scripts & the Twilio API to keep track of when things go out of stock">
<meta property="og:url" content="http://noahmanion.github.io/adwords-scripting/">
<meta property="og:site_name" content="Noah Manion: These are my thoughts.">

<meta property="og:image" content="http://noahmanion.github.io/images/l.jpg">






<link rel="canonical" href="http://noahmanion.github.io/adwords-scripting/">
<link href="http://noahmanion.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Noah Manion: These are my thoughts. Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://noahmanion.github.io/assets/css/main.css">


<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://noahmanion.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://noahmanion.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->



<!-- Modernizr -->
<script src="http://noahmanion.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://noahmanion.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://noahmanion.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://noahmanion.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://noahmanion.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://noahmanion.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://noahmanion.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://noahmanion.github.io/">Noah Manion: These are my thoughts.</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				    <li><a href="http://noahmanion.github.io/about/" >About</a></li>
				
				    
				    <li><a href="http://noahmanion.github.io/posts/" >Posts</a></li>
				
				    
				    <li><a href="http://noahmanion.github.io/pages/" >Pages</a></li>
				
				    
				    <li><a href="http://noahmanion.github.io" target="_blank">Noah Manion</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "http://noahmanion.github.io/images/l.jpg"
    
  alt="Adwords Scripts feature image">
  
    <span class="image-credit">Photo Credit: <a href="https://instagram.com/andnoahsaid">IG</a></span>
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="http://schema.org/Person">


	<img src="http://noahmanion.github.io/images/bio-photo.jpg" class="bio-photo" alt="Noah Manion bio photo">


  <h3 itemprop="name">Noah Manion</h3>
  <p>Growth/Marketing by day; asprining develper by night; hockey fan, pickle and controlled spoilage enthusiast.</p>
  
  <a href="http://twitter.com/noahmanion" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  <a href="http://facebook.com/noermanion" class="author-social" target="_blank"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a>
  
  <a href="http://linkedin.com/in/noahmanion" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  <a href="http://instagram.com/andnoahsaid" class="author-social" target="_blank"><i class="fa fa-fw fa-instagram"></i> Instagram</a>
  
  <a href="http://github.com/noahmanion" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://noahmanion.github.io/adwords-scripting/" rel="bookmark" title="Adwords Scripts">Adwords Scripts</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <h1 id="advertise-products-online-and-have-problems-when-things-are-out-of-stock">Advertise products online and have problems when things are out of stock?</h1>

<p>I had a problem where I was running product ads on a variety of platforms, but things would go out of stock and my application wasn’t able to automatically turn ads off. I figured out a way to use Adwords Scripts &amp; the Twilio API to notify me of these changes!</p>

<h2 id="the-problem">The problem:</h2>
<p>I was working on a project where I was advertising products that had limited quantities that I wasn’t aware of, and multiple referral sources bringing traffic to the product page. In addition, the action I was tracking to use as a conersion wasn’t necessarily a purchase, pageview or outbound click. Couple that with a conversion tracking system that wans’t always accurate and I had a real issue on my hands.
For the first few months of the project, I just sent traffic to the product lisitng page and waited until someone watching the page notified me that the product was no longer available. This worked out for awhile until there was a miscommunication and I ended up paying several thousand dollars to send traffic to an inactive page. 
I had been looking into AdWords Scripts for awhile to automate some AdWords work I was doing and I came across <a href="http://www.freeadwordsscripts.com">FreeAdwordsScripts.com</a> and began to explore how some of the example scripts there could help. I learned how to connect a script to a Google Sheet and extract infromation, and I found the most helpful example <a href="http://www.freeadwordsscripts.com/2014/01/make-calls-and-send-text-messages-to.html">how to connect the Twilio API</a> to your Scripts account, thus allowing you automate text messages reporiting anomalies with your account (or in my case, pages I was tracking).
<a href="https://docs.google.com/spreadsheets/d/1wMtmhR7um578l4HWVf-PSa0e1KLoR-5u8khbxj1CVLg/edit?usp=sharing">Here’s a spreadsheet to copy</a>. The sheet uses the named range in the sheet to run. If you only need to track one URL</p>

<h2 id="heres-the-full-code">Here’s the full code:</h2>
<p>```javascript
/<strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>**</strong><strong>*
<em>Out of Stock Checker Script v2.3
*
*
*2.3 changes: Added Twilio capibility to send texts when there is a problem with a URL
**</em></strong>*/</p>

<p>//variables needed for teh script
var spreadsheet_url = “SPREADSHEET_URL_HERE”;</p>

<p>var TEXT_CHANGED = “Whatever you’re looking to track”;
var subject = “URL CHANGE!”;
var recipient = “you@example.com”;
var results = “There was a change at: “;
var sid = ‘GET_YOUR_OWN’;
var auth = ‘FROM_TWILIO’;
var client = new Twilio(sid,auth);</p>

<p>function main() {
	//put a spreadsheet range into an array
	var iter = buildSelector();
	for (var i = 0; i &lt; iter.length; i++) {
		//iterate through the range to create urls to fetch
		var deal = iter[i];
		//get the source of an item in the array
		htmlCode = UrlFetchApp.fetch(deal).getContentText();
		//check the source for text
		if (htmlCode.indexOf(TEXT_CHANGED) &gt;= 0) {
			//send an email if changed
			MailApp.sendEmail(recipient, subject, results+entity);
			//send a text if changed
			client.sendMessage(‘+14124179263’,’+13123136668’,”This Deal Has Expired: “+deal)
        	//log the expired urls. mostly here as a debugger
        	Logger.log(“this is expired: “+deal);
		} else {
			//log the good urls. mostly here as a debugger
			Logger.log(deal+” is good”)
		}
	} 
}</p>

<p>function buildSelector () {
	var spreadsheet = SpreadsheetApp.openByUrl(spreadsheet_url);
	var sheet = spreadsheet.getRangeByName(‘URLS_TO_TRACK’);
	var selector = new Array();
	var sheet_values = sheet.getValues();
	for (var i = 0; i &lt; sheet_values.length; i++) {
		//if(sheet_values[i][0] == “”){
			//continue
			//var selector = sheet_values;
		//}
			var selector = sheet_values
	}
	return selector;
	//Logger.log(selector);
}</p>

<p>function Twilio(accountSid, authToken) {
  this.ACCOUNT_SID = accountSid;
  this.AUTH_TOKEN = authToken;</p>

<p>this.MESSAGES_ENDPOINT = ‘https://api.twilio.com/2010-04-01/Accounts/’+this.ACCOUNT_SID+’/Messages.json’;
  this.CALLS_ENDPOINT = ‘https://api.twilio.com/2010-04-01/Accounts/’+this.ACCOUNT_SID+’/Calls.json’;</p>

<p>this.sendMessage = function(to,from,body) {
    var httpOptions = {
      method : ‘POST’,
      payload : {
        To: to,
        From: from,
        Body: body
      },
      headers : getBasicAuth(this)
    };
    var resp = UrlFetchApp.fetch(this.MESSAGES_ENDPOINT, httpOptions).getContentText();
    return JSON.parse(resp)[‘sid’];
  }</p>

<p>this.makeCall = function(to,from,whatToSay) {
    var url = ‘http://proj.rjsavage.com/savageautomation/twilio_script/dynamicSay.php?alert=’+encodeURIComponent(whatToSay);
    var httpOptions = {
      method : ‘POST’,
      payload : {
        To: to,
        From: from,
        Url: url
      },
      headers : getBasicAuth(this)
    };
    var resp = UrlFetchApp.fetch(this.CALLS_ENDPOINT, httpOptions).getContentText();
    return JSON.parse(resp)[‘sid’];</p>

<p>function getBasicAuth(context) {
    return {
      ‘Authorization’: ‘Basic ‘ + Utilities.base64Encode(context.ACCOUNT_SID+’:’+context.AUTH_TOKEN)
    };
  }
}
```</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://noahmanion.github.io/adwords-scripting/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://noahmanion.github.io/adwords-scripting/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://noahmanion.github.io/adwords-scripting/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Adwords Scripts</strong> was published on <time datetime="2015-11-10T22:37:57-06:00">November 10, 2015</time> and last modified on <time datetime="2015-12-04">December 04, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://noahmanion.github.io/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="http://noahmanion.github.io/is-this-on/" title="Test Post">Test Post</a></li>
    
      <li><a href="http://noahmanion.github.io/first-post/" title="First Post">First Post</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  
  <footer>
    
<iframe src="https://www.linkedin.com/in/noahmanion" height="1" width="1" frameBorder="0"></iframe>


<span>&copy; 2016 Noah Manion. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://noahmanion.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://noahmanion.github.io/assets/js/scripts.min.js"></script>
<!-- Ouibounce -->
<script src="http://noahmanion.github.io/assets/js/plugins/ouibounce.js" ></script>




</body>
</html>
